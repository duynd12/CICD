name: Laravel CD

on:
  workflow_run:
    workflows: ["Laravel CI"]   # ðŸ‘ˆ TÃªn workflow CI
    types:
      - completed

jobs:
  deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source
        uses: actions/checkout@v3

      - name: Set up PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.1'

      - name: Deploy to server
        run: |
          echo "Deploying project..."
          # VÃ­ dá»¥ deploy báº±ng rsync/ssh
          # rsync -avz --exclude='.git' ./ user@server:/var/www/laravel
          # ssh user@server "cd /var/www/laravel && php artisan migrate --force && php artisan config:clear"
